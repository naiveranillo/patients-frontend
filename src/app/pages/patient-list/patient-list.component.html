<header>
    <h1>Lista de pacientes</h1>
    <p-button routerLink="/app/create" label="Crear Paciente" styleClass="p-button" icon="pi pi-plus"></p-button>
</header>

<div class="mt-5">
    <div class="flex justify-content-end gap-2 mb-3">
        <div class="flex flex-column gap-2">
            <label for="name">Nombre</label>
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input [(ngModel)]="name" type="text" pInputText />
            </span>
        </div>
        <div class="flex flex-column gap-2">
            <label for="document">Documento</label>
            <p-inputNumber [(ngModel)]="documentNumber" mode="decimal" inputId="document" [useGrouping]="false"> </p-inputNumber>
        </div>
        <div class="flex align-items-end">
            <p-button label="Buscar" (click)="getPatients()" [loading]="loadingButton" styleClass="p-button" icon="pi pi-search"></p-button>
        </div>
    </div>

    <p-table [loading]="loadingTable" [value]="patients" [scrollable]="true" scrollHeight="400px" styleClass="p-datatable-sm" [tableStyle]="{'min-width': '50rem'}">
        <ng-template pTemplate="header">
            <tr>
                <th>Documento</th>
                <th>Nombre</th>
                <th>Apellidos</th>
                <th>Email</th>
                <th>Teléfono</th>
                <th>Fecha creación</th>
                <th>Opciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-patients>
            <tr>
                <td>{{patients.documentNumber}}</td>
                <td>{{patients.firstName}}</td>
                <td>{{patients.lastName}}</td>
                <td>{{patients.email}}</td>
                <td>{{ patients.phoneNumber == null ? "No Disponible" : patients.phoneNumber }}</td>
                <td>{{patients.createdAt | date: 'dd/MM/yyyy'}}</td>
                <td class="flex gap-2">
                    <p-button [routerLink]="['/app/details', patients.patientId]" icon="pi pi-align-justify" styleClass="p-button-primary" pTooltip="Ver detalles" tooltipPosition="top"></p-button>
                    <p-button [routerLink]="['/app/edit', patients.patientId]" icon="pi pi-user-edit" styleClass="p-button-warning" pTooltip="Editar" tooltipPosition="top"></p-button>
                    <div class="flex justify-content-center">
                        <p-confirmPopup></p-confirmPopup>
                        <p-button type="button" icon="pi pi-times" (click)="confirm($event, patients)" styleClass="p-button-danger" pTooltip="Eliminar" tooltipPosition="top"></p-button>   
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="card flex justify-content-end">
        <p-paginator (onPageChange)="onPageChange($event)" [first]="page * pageSize" [rows]="pageSize" [totalRecords]="total"></p-paginator>
    </div>
</div>
